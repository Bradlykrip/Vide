var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};!function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports);void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define(["require","exports","path","fs","process"],e)}(function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.run=t.config=void 0;const n=__importDefault(e("path")),o=__importDefault(e("fs")),i=e("process"),s=e("dirty-json"),l=e("chalk");console.log(`${l.blue("●")} Reading config`);let c=()=>{};const f=(e,t=[])=>(o.default.readdirSync(e).forEach(i=>{t=o.default.statSync(n.default.join(e,i)).isDirectory()?f(n.default.join(e,i),t):t.concat(n.default.join(e,i))}),t),r=f("."),d=[];for(let e=0;e<r.length;e++){const t=r[e];if(t.includes("videfile"))d.push(t);else{}}if(d.length>1){console.log(`   ${l.red("●")} Two videfiles detected expected one. At the following paths:`),d.forEach(e=>{console.log(`      ${l.yellow("●")} ${e}`)}),i.exit()}let u;const a=o.default.readFileSync(`./${d[0]}`,"utf-8");if(a.includes("use non-standard")){const e=a.split("\n");e.shift();const t=[];e.forEach((n,o)=>{if(n.includes("//"))e.splice(o,1);else if(n.includes("run {")){const t=e.filter(e=>"}"===e),n=e.indexOf(t[0]),o=e.filter(e=>"run {"===e)[0],i=e.slice(e.indexOf(o),n);i.splice(0,1);const s=i.map(e=>e.trim()).join("\n");c=new Function(s)}else{const e=n.split(" ");if(""===e[0]);else{const n={func:e[0],args:e[1],line:o};t.push(n)}}});const n={};for(let e=0;e<t.length;e++){const o=t[e];"}"!==o.func&&(n[o.func]=o.args)}u=n}else{const e=`{\n${a}\n}`;try{u=s.parse(e)}catch(e){console.log(`${l.red("   ●")} Using non standard library in standard module.`)}}t.config=u,t.run=c});